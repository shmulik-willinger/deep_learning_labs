<!DOCTYPE html>
<!-- saved from url=(0144)http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Neural Network Deployment with DIGITS and TensorRT</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/base/images/favicon.ico?v=30780f272ab4aac64aa073a841546240">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Neural Network Deployment with DIGITS and TensorRT_files/jquery-ui.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Neural Network Deployment with DIGITS and TensorRT_files/MathJax.js.download" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/jrYW68Fsc/static/mathjax/MathJax.js";
</script>

<link rel="stylesheet" href="./Neural Network Deployment with DIGITS and TensorRT_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Neural Network Deployment with DIGITS and TensorRT_files/codemirror.css">


    <link rel="stylesheet" href="./Neural Network Deployment with DIGITS and TensorRT_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Neural Network Deployment with DIGITS and TensorRT_files/override.css" type="text/css">
<link rel="stylesheet" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Neural Network Deployment with DIGITS and TensorRT_files/custom.css" type="text/css">
    <script src="./Neural Network Deployment with DIGITS and TensorRT_files/promise.min.js.download" type="text/javascript" charset="utf-8"></script>
    <script src="./Neural Network Deployment with DIGITS and TensorRT_files/require.js.download" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20171017122510",
          
          baseUrl: '/jrYW68Fsc/static/',
          paths: {
            nbextensions : '/jrYW68Fsc/nbextensions',
            kernelspecs : '/jrYW68Fsc/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            jqueryui: 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/term.js/src/term',
          },
          shim: {
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            jqueryui: {
              deps: ["jquery"],
              exports: "$"
            }
          }
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/namespace" src="./Neural Network Deployment with DIGITS and TensorRT_files/namespace.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="jquery" src="./Neural Network Deployment with DIGITS and TensorRT_files/jquery.min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/notebook" src="./Neural Network Deployment with DIGITS and TensorRT_files/notebook.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Neural Network Deployment with DIGITS and TensorRT_files/contents.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/config" src="./Neural Network Deployment with DIGITS and TensorRT_files/config.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/utils" src="./Neural Network Deployment with DIGITS and TensorRT_files/utils.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/page" src="./Neural Network Deployment with DIGITS and TensorRT_files/page.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/events" src="./Neural Network Deployment with DIGITS and TensorRT_files/events.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="auth/js/loginwidget" src="./Neural Network Deployment with DIGITS and TensorRT_files/loginwidget.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/maintoolbar" src="./Neural Network Deployment with DIGITS and TensorRT_files/maintoolbar.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/pager" src="./Neural Network Deployment with DIGITS and TensorRT_files/pager.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/quickhelp" src="./Neural Network Deployment with DIGITS and TensorRT_files/quickhelp.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/menubar" src="./Neural Network Deployment with DIGITS and TensorRT_files/menubar.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/notificationarea" src="./Neural Network Deployment with DIGITS and TensorRT_files/notificationarea.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/savewidget" src="./Neural Network Deployment with DIGITS and TensorRT_files/savewidget.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/actions" src="./Neural Network Deployment with DIGITS and TensorRT_files/actions.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/keyboardmanager" src="./Neural Network Deployment with DIGITS and TensorRT_files/keyboardmanager.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/kernelselector" src="./Neural Network Deployment with DIGITS and TensorRT_files/kernelselector.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/lib/codemirror" src="./Neural Network Deployment with DIGITS and TensorRT_files/codemirror.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/about" src="./Neural Network Deployment with DIGITS and TensorRT_files/about.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Neural Network Deployment with DIGITS and TensorRT_files/custom.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/dialog" src="./Neural Network Deployment with DIGITS and TensorRT_files/dialog.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/cell" src="./Neural Network Deployment with DIGITS and TensorRT_files/cell.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/textcell" src="./Neural Network Deployment with DIGITS and TensorRT_files/textcell.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/codecell" src="./Neural Network Deployment with DIGITS and TensorRT_files/codecell.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="moment" src="./Neural Network Deployment with DIGITS and TensorRT_files/moment.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/sessions/session" src="./Neural Network Deployment with DIGITS and TensorRT_files/session.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbar" src="./Neural Network Deployment with DIGITS and TensorRT_files/celltoolbar.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="components/marked/lib/marked" src="./Neural Network Deployment with DIGITS and TensorRT_files/marked.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/runmode/runmode" src="./Neural Network Deployment with DIGITS and TensorRT_files/runmode.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/mathjaxutils" src="./Neural Network Deployment with DIGITS and TensorRT_files/mathjaxutils.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/keyboard" src="./Neural Network Deployment with DIGITS and TensorRT_files/keyboard.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/tooltip" src="./Neural Network Deployment with DIGITS and TensorRT_files/tooltip.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbarpresets/default" src="./Neural Network Deployment with DIGITS and TensorRT_files/default.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbarpresets/rawcell" src="./Neural Network Deployment with DIGITS and TensorRT_files/rawcell.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbarpresets/slideshow" src="./Neural Network Deployment with DIGITS and TensorRT_files/slideshow.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/scrollmanager" src="./Neural Network Deployment with DIGITS and TensorRT_files/scrollmanager.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/toolbar" src="./Neural Network Deployment with DIGITS and TensorRT_files/toolbar.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/tour" src="./Neural Network Deployment with DIGITS and TensorRT_files/tour.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/meta" src="./Neural Network Deployment with DIGITS and TensorRT_files/meta.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/notificationarea" src="./Neural Network Deployment with DIGITS and TensorRT_files/notificationarea.js(1).download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="underscore" src="./Neural Network Deployment with DIGITS and TensorRT_files/underscore-min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/security" src="./Neural Network Deployment with DIGITS and TensorRT_files/security.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/gfm/gfm" src="./Neural Network Deployment with DIGITS and TensorRT_files/gfm.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/codemirror-ipythongfm" src="./Neural Network Deployment with DIGITS and TensorRT_files/codemirror-ipythongfm.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/edit/matchbrackets" src="./Neural Network Deployment with DIGITS and TensorRT_files/matchbrackets.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/edit/closebrackets" src="./Neural Network Deployment with DIGITS and TensorRT_files/closebrackets.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/comment/comment" src="./Neural Network Deployment with DIGITS and TensorRT_files/comment.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/kernels/kernel" src="./Neural Network Deployment with DIGITS and TensorRT_files/kernel.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/outputarea" src="./Neural Network Deployment with DIGITS and TensorRT_files/outputarea.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/completer" src="./Neural Network Deployment with DIGITS and TensorRT_files/completer.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/python/python" src="./Neural Network Deployment with DIGITS and TensorRT_files/python.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/codemirror-ipython" src="./Neural Network Deployment with DIGITS and TensorRT_files/codemirror-ipython.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/notificationwidget" src="./Neural Network Deployment with DIGITS and TensorRT_files/notificationwidget.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="components/google-caja/html-css-sanitizer-minified" src="./Neural Network Deployment with DIGITS and TensorRT_files/html-css-sanitizer-minified.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/mode/multiplex" src="./Neural Network Deployment with DIGITS and TensorRT_files/multiplex.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/stex/stex" src="./Neural Network Deployment with DIGITS and TensorRT_files/stex.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/markdown/markdown" src="./Neural Network Deployment with DIGITS and TensorRT_files/markdown.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/mode/overlay" src="./Neural Network Deployment with DIGITS and TensorRT_files/overlay.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/contexthint" src="./Neural Network Deployment with DIGITS and TensorRT_files/contexthint.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/kernels/comm" src="./Neural Network Deployment with DIGITS and TensorRT_files/comm.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/kernels/serialize" src="./Neural Network Deployment with DIGITS and TensorRT_files/serialize.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/init" src="./Neural Network Deployment with DIGITS and TensorRT_files/init.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="jqueryui" src="./Neural Network Deployment with DIGITS and TensorRT_files/jquery-ui.min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="bootstrap" src="./Neural Network Deployment with DIGITS and TensorRT_files/bootstrap.min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/manager" src="./Neural Network Deployment with DIGITS and TensorRT_files/manager.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_link" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_link.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_bool" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_bool.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_button" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_button.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_box" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_box.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_float" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_float.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_image" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_image.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_int" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_int.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_output" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_output.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_selection" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_selection.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_selectioncontainer" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_selectioncontainer.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_string" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget_string.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget" src="./Neural Network Deployment with DIGITS and TensorRT_files/widget.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="bootstraptour" src="./Neural Network Deployment with DIGITS and TensorRT_files/bootstrap-tour.min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="backbone" src="./Neural Network Deployment with DIGITS and TensorRT_files/backbone-min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/xml/xml" src="./Neural Network Deployment with DIGITS and TensorRT_files/xml.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.5.3') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="notebook_app command_mode" data-project="" data-base-url="/jrYW68Fsc/" data-ws-url="" data-notebook-name="Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb" data-notebook-path="Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    &lt;div id='noscript'&gt;
      IPython Notebook requires JavaScript.&lt;br&gt;
      Please enable it to proceed.
  &lt;/div&gt;
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/tree" title="dashboard"><img src="./Neural Network Deployment with DIGITS and TensorRT_files/logo.png" alt="Jupyter Notebook"></a></div>

  

  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Neural Network Deployment with DIGITS and TensorRT</span>
    <span class="checkpoint_status" title="no checkpoint"></span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  <img class="current_kernel_logo" src="./Neural Network Deployment with DIGITS and TensorRT_files/logo-64x64.png" style="display: inline;">
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 2</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown open"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python2"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Python 2</a></li><li class="divider"></li><li id="new-notebook-submenu-itorch"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">iTorch</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li class="disabled"><a>No checkpoints</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Download as</a>
                            <ul class="dropdown-menu">
                                <li id="download_ipynb"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">IPython Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">reST (.rst)</a></li>
                                <li id="download_pdf"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Trust Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Cut Cell</a></li>
                        <li id="copy_cell"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Copy Cell</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Paste Cell Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Paste Cell Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Paste Cell &amp; Replace</a></li>
                        <li id="delete_cell"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Delete Cell</a></li>
                        <li id="undelete_cell" class="disabled"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Undo Delete Cell</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Edit Notebook Metadata</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the IPython Notebook logo and notebook title (above menu bar)">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Toggle Header</a></li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Toggle Toolbar</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Run</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Run and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Run and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Current Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Restart</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Reconnect</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Python 2</a></li><li id="kernel-submenu-itorch"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">iTorch</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                <i class="fa fa-external-link menu-icon pull-right"></i>
                                Notebook Help
                                </a></li>
                            
                                <li><a href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                <i class="fa fa-external-link menu-icon pull-right"></i>
                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/2.7"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About IPython Notebook"><a id="notebook_about" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#">About</a></li>
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="ipython.save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="ipython.insert-cell-after"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cell" data-jupyter-action="ipython.cut-selected-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cell" data-jupyter-action="ipython.copy-selected-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cell below" data-jupyter-action="ipython.paste-cell-after"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cell up" data-jupyter-action="ipython.move-selected-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cell down" data-jupyter-action="ipython.move-selected-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="ipython.run-select-next"><i class="fa-play fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="ipython.interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart kernel" data-jupyter-action="ipython.restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option></select><div class="btn-group"><span class="navbar-text">Cell Toolbar:</span><select id="ctb_select" class="form-control select-xs"><option value="">None</option><option value="Edit Metadata">Edit Metadata</option><option value="Raw Cell Format">Raw Cell Format</option><option value="Slideshow">Slideshow</option></select></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="display: block; height: 482px;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://www.nvidia.com/en-us/deep-learning-ai/education/</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"files/DLI Header.png"</span> <span class="cm-attribute">alt</span>=<span class="cm-string">"Header"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 400px;"</span><span class="cm-tag cm-bracket">/&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><a href="https://www.nvidia.com/en-us/deep-learning-ai/education/" target="_blank"> <img src="./Neural Network Deployment with DIGITS and TensorRT_files/DLI Header.png" alt="Header" style="width: 400px"> </a></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 66px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Deep Learning Network Deployment</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">By Jon Barker and Ryan Olson</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 79px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Deep-Learning-Network-Deployment">Deep Learning Network Deployment<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Deep-Learning-Network-Deployment"></a></h1>
<p>By Jon Barker and Ryan Olson</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Before we begin, let's verify <span class="cm-link">[WebSockets]</span><span class="cm-string">(http://en.wikipedia.org/wiki/WebSocket)</span> are working on your system.  To do this, execute the cell block below by giving it focus (clicking on it with your mouse), and hitting Ctrl-Enter, or pressing the play button in the toolbar above.  If all goes well, you should see get some output returned below the grey cell.  If not, please consult the <span class="cm-link">[Self-paced Lab Troubleshooting FAQ]</span><span class="cm-string">(https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting)</span> to debug the issue.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Before we begin, let's verify <a href="http://en.wikipedia.org/wiki/WebSocket" target="_blank">WebSockets</a> are working on your system.  To do this, execute the cell block below by giving it focus (clicking on it with your mouse), and hitting Ctrl-Enter, or pressing the play button in the toolbar above.  If all goes well, you should see get some output returned below the grey cell.  If not, please consult the <a href="https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting" target="_blank">Self-paced Lab Troubleshooting FAQ</a> to debug the issue.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[1]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 367.25px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 364.656px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 361.656px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">"The answer should be three: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-number">1</span><span class="cm-operator">+</span><span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>The answer should be three: 3
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Let's execute the cell below to display information about the GPUs running on the server.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Let's execute the cell below to display information about the GPUs running on the server.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 90.2188px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 87.625px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 84.625px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">nvidia</span><span class="cm-operator">-</span><span class="cm-variable">smi</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tue Oct 17 13:21:34 2017       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 367.44                 Driver Version: 367.44                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  GRID K520           On   | 0000:00:03.0     Off |                  N/A |
| N/A   54C    P8    18W / 125W |     37MiB /  4036MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|=============================================================================|
|    0      2528    C   /usr/bin/python                                 35MiB |
+-----------------------------------------------------------------------------+
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-hr">---</span></span></pre><pre class=""><span style="padding-right: 0.1px;">The following video will explain the infrastructure we are using for this self-paced lab, as well as give some tips on it's usage.  If you've never taken a lab on this sytem before, it's highly recommended you watch this short video first.<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-link">[</span><span class="cm-tag">![Intro]</span><span class="cm-string">(http://img.youtube.com/vi/ZMrDaLSFqpY/0.jpg)</span><span class="cm-link">]</span><span class="cm-string">(http://www.youtube.com/watch?v=ZMrDaLSFqpY "Intro to NVIDIA's Self-Paced Lab Infrastructure")</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><hr>
<p>The following video will explain the infrastructure we are using for this self-paced lab, as well as give some tips on it's usage.  If you've never taken a lab on this sytem before, it's highly recommended you watch this short video first.<br><br>
<a href="http://www.youtube.com/watch?v=ZMrDaLSFqpY" title="Intro to NVIDIA&#39;s Self-Paced Lab Infrastructure" target="_blank"><img src="./Neural Network Deployment with DIGITS and TensorRT_files/0.jpg" alt="Intro"></a></p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 235px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Introduction</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Welcome to NVIDIA's deep learning network deployment lab.  In previous labs, you learned to <span class="cm-em">*train*</span> deep neural networks. You also performed basic <span class="cm-em">*inference*</span> for visualization and testing. In this lab, you'll gain the skills to deploy your network for production. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You'll use DIGITS, Caffe and TensorRT to deploy networks trained in DIGITS. You will experiment with the effect of batch size on throughput and latency while using Caffe for object detection. You'll also assess the performance difference between Caffe and TensorRT by using both for efficient image classification.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Whether you're classifying images to help fight cancer or detecting objects to avoid pedestrians in self-driving cars, deployment is where you'll solve the problem you set out to solve. Your network <span class="cm-strong">**uses what it learned**</span> during training <span class="cm-strong">**to make decisions**</span> in the real world.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 235px;"></div><div class="CodeMirror-gutters" style="display: none; height: 248px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Introduction">Introduction<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Introduction"></a></h2>
<p>Welcome to NVIDIA's deep learning network deployment lab.  In previous labs, you learned to <em>train</em> deep neural networks. You also performed basic <em>inference</em> for visualization and testing. In this lab, you'll gain the skills to deploy your network for production. </p>
<p>You'll use DIGITS, Caffe and TensorRT to deploy networks trained in DIGITS. You will experiment with the effect of batch size on throughput and latency while using Caffe for object detection. You'll also assess the performance difference between Caffe and TensorRT by using both for efficient image classification.</p>
<p>Whether you're classifying images to help fight cancer or detecting objects to avoid pedestrians in self-driving cars, deployment is where you'll solve the problem you set out to solve. Your network <strong>uses what it learned</strong> during training <strong>to make decisions</strong> in the real world.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 1686px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## GPU acceleration for training and deployment</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">GPU acceleration improves performance in both phases of machine learning solutions: training and deployment.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Training</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">In <span class="cm-link">[Getting Started with Deep Learning,]</span><span class="cm-string">(https://nvidia.qwiklab.com/focuses/preview/1579?locale=en)</span> you learned how to create, train, and test a deep neural network. You saw how GPUs greatly accelerate training. Due to the size of datasets and the depth of neural networks, training is typically very resource-intensive. What can take weeks or months on traditional compute architectures takes days or hours using GPUs.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/dnn.png)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Deployment</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-em">*Inference*</span> is the process of using a trained model to make predictions from new data. <span class="cm-em">*Deployment*</span> is <span class="cm-em">*inference*</span> in a production environment such as a data center, an automobile, or an embedded platform. Due to the depth of deep neural networks, inference also requires significant compute resources to process in realtime on imagery or other high-volume sensor data. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">GPU acceleration can also be utilized during inference. <span class="cm-link">[NVIDIA Jetson's TX1 and TX2]</span><span class="cm-string">(http://www.nvidia.com/object/embedded-systems-dev-kits-modules.html)</span> integrated NVIDIA GPU deployed onboard embedded platforms and <span class="cm-link">[NVIDIA Drive PX2]</span><span class="cm-string">(http://www.nvidia.com/object/drive-px.html)</span> enable real-time inference in robotics applications like picking, autonomous navigation, agriculture, and industrial inspection.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Completing a deep learning workflow: Inference and Deployment</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">The typical training and inference cycle is depicted below.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"files/digits_workflow.png"</span> <span class="cm-attribute">alt</span>=<span class="cm-string">"Drawing"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: =800px;"</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">This lab will focus on the right-hand side of the diagram. We'll deploy two networks, <span class="cm-em">*GoogLeNet*</span> and <span class="cm-em">*pedestrian_detectNet:*</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-em cm-variable-2">*GoogLeNet*</span><span class="cm-variable-2"> is a well known convolutional neural network (CNN) architecture that has been trained for image classification using  the </span><span class="cm-link cm-variable-2">[ilsvrc12 Imagenet]</span><span class="cm-string">(http://www.image-net.org/challenges/LSVRC/2012/)</span><span class="cm-variable-2"> dataset.  This network can assign one of 1000 class class labels to an entire image based on the dominant object present. The classes this model can recognize can be found </span><span class="cm-link cm-variable-2">[here]</span><span class="cm-string">(http://image-net.org/challenges/LSVRC/2012/browse-synsets)</span><span class="cm-variable-2">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-em cm-variable-2">*pedestrian_detectNet*</span><span class="cm-variable-2"> is another CNN architecture that is not only able to assign a global classification to an image but can go further and detect multiple objects within the image and draw bounding boxes around them.  The pre-trained model provided has been trained for the task of pedestrian detection using a large dataset of pedestrians in a variety of indoor and outdoor scenes.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">After reviewing inference in DIGITS, we'll deploy the network in two ways:</span></pre><pre class=""><span style="padding-right: 0.1px;">1. <span class="cm-em">*Using the trained model as-is*</span> using pycaffe, a python based deep learning framework API. </span></pre><pre class=""><span style="padding-right: 0.1px;">2. <span class="cm-em">*Optimizing the model for production*</span> using Nvidia TensorRT, a high-performance deep learning inference engine.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You'll compare and contrast the process for different networks, tasks and deployment frameworks and identify the impact of batch size in optimizing for throughput vs. latency.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You'll always start with a model definition and trained weights. In this lab, we'll find those directly in DIGITS. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Part 1: DIGITS</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">DIGITS is an open-source project contributed by NVIDIA.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">As you saw in <span class="cm-link">[Getting Started with Deep Learning,]</span><span class="cm-string">(https://nvidia.qwiklab.com/focuses/preview/1579?locale=en)</span> DIGITS allows anyone to easily get started and interactively <span class="cm-em">*train*</span> their networks with GPU acceleration. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You also saw that any pre-trained model in DIGITS can immediately be applied to a new test image through the same browser interface in which it was trained. This is <span class="cm-em">*inference.*</span> <span class="cm-em">*Inference*</span> is a network's main job once deployed, so we'll use DIGITS as a first step.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-hr">---</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Click <span class="cm-link">[here]</span><span class="cm-string">(/digits/)</span> to open DIGITS in a separate tab.  If at any time DIGITS asks you to login you can just make up a username and proceed.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">The DIGITS server you will see running contains our two neural networks, <span class="cm-em">*GoogLeNet*</span> and <span class="cm-em">*pedestrian_detectNet*</span>, listed under the <span class="cm-comment">`"Models"`</span> tab:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/pretrained.png)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Click on the name of one of the models and scroll to the bottom to see the "Trained Models" view.  Here, you can <span class="cm-em">*apply*</span> the model to a single test image, a whole LMDB database of test images or a list of files referenced in a text file. Note that you have different options depending on the model you're using.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise:**</span> Follow the instructions in the image below to test the following single images that reside on the same server as the running DIGITS instance:</span></pre><pre class=""><span style="padding-right: 0.1px;">1. For <span class="cm-em">*GoogLeNet:*</span> /home/ubuntu/deployment_lab/test_images/GN_test.png</span></pre><pre class=""><span style="padding-right: 0.1px;">2. For <span class="cm-em">*pedestrian_detectNet:*</span> /home/ubuntu/deployment_lab/test_images/DN_test.png</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/digits_inference.png)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">If you successfully follow these steps you should see one of the inference outputs below:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/digits_inference_outputs.png)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-strong">**Optional Exercise - The power of additional computation**</span>) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Carry out the same inference task again using DetectNet but this time select a version of the model from an earlier epoch in the training process using <span class="cm-comment">`"Select Model`</span>" dropdown.  You should find that models from earlier epochs produce less accurate detection results. Note that this is usually, but <span class="cm-link">[not always]</span><span class="cm-string">(http://docs.aws.amazon.com/machine-learning/latest/dg/model-fit-underfitting-vs-overfitting.html)</span> the case. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">We've now used our trained network to make inferences on new data. Next, we'll deploy our model to production to carry out inference programatically. We'll start with a simple Python application that uses pycaffe, the same framework that DIGITS just used to infer. Through this process, we'll identify the files you need from DIGITS for deployment. You'll also learn to optimize your deployment for either throughput or latency by manipulating batch size.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 1686px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1699px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="GPU-acceleration-for-training-and-deployment">GPU acceleration for training and deployment<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#GPU-acceleration-for-training-and-deployment"></a></h2>
<p>GPU acceleration improves performance in both phases of machine learning solutions: training and deployment.</p>
<h3 id="Training">Training<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Training"></a></h3>
<p>In <a href="https://nvidia.qwiklab.com/focuses/preview/1579?locale=en" target="_blank">Getting Started with Deep Learning,</a> you learned how to create, train, and test a deep neural network. You saw how GPUs greatly accelerate training. Due to the size of datasets and the depth of neural networks, training is typically very resource-intensive. What can take weeks or months on traditional compute architectures takes days or hours using GPUs.</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/dnn.png" alt=""></p>
<h3 id="Deployment">Deployment<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Deployment"></a></h3>
<p><em>Inference</em> is the process of using a trained model to make predictions from new data. <em>Deployment</em> is <em>inference</em> in a production environment such as a data center, an automobile, or an embedded platform. Due to the depth of deep neural networks, inference also requires significant compute resources to process in realtime on imagery or other high-volume sensor data. </p>
<p>GPU acceleration can also be utilized during inference. <a href="http://www.nvidia.com/object/embedded-systems-dev-kits-modules.html" target="_blank">NVIDIA Jetson's TX1 and TX2</a> integrated NVIDIA GPU deployed onboard embedded platforms and <a href="http://www.nvidia.com/object/drive-px.html" target="_blank">NVIDIA Drive PX2</a> enable real-time inference in robotics applications like picking, autonomous navigation, agriculture, and industrial inspection.</p>
<h2 id="Completing-a-deep-learning-workflow:-Inference-and-Deployment">Completing a deep learning workflow: Inference and Deployment<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Completing-a-deep-learning-workflow:-Inference-and-Deployment"></a></h2>
<p>The typical training and inference cycle is depicted below.</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/digits_workflow.png" alt="Drawing" style="width: 800px"></p>
<p>This lab will focus on the right-hand side of the diagram. We'll deploy two networks, <em>GoogLeNet</em> and <em>pedestrian_detectNet:</em></p>
<ul>
<li><p><em>GoogLeNet</em> is a well known convolutional neural network (CNN) architecture that has been trained for image classification using  the <a href="http://www.image-net.org/challenges/LSVRC/2012/" target="_blank">ilsvrc12 Imagenet</a> dataset.  This network can assign one of 1000 class class labels to an entire image based on the dominant object present. The classes this model can recognize can be found <a href="http://image-net.org/challenges/LSVRC/2012/browse-synsets" target="_blank">here</a>.</p>
</li>
<li><p><em>pedestrian_detectNet</em> is another CNN architecture that is not only able to assign a global classification to an image but can go further and detect multiple objects within the image and draw bounding boxes around them.  The pre-trained model provided has been trained for the task of pedestrian detection using a large dataset of pedestrians in a variety of indoor and outdoor scenes.</p>
</li>
</ul>
<p>After reviewing inference in DIGITS, we'll deploy the network in two ways:</p>
<ol>
<li><em>Using the trained model as-is</em> using pycaffe, a python based deep learning framework API. </li>
<li><em>Optimizing the model for production</em> using Nvidia TensorRT, a high-performance deep learning inference engine.</li>
</ol>
<p>You'll compare and contrast the process for different networks, tasks and deployment frameworks and identify the impact of batch size in optimizing for throughput vs. latency.</p>
<p>You'll always start with a model definition and trained weights. In this lab, we'll find those directly in DIGITS. </p>
<h3 id="Part-1:-DIGITS">Part 1: DIGITS<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Part-1:-DIGITS"></a></h3>
<p>DIGITS is an open-source project contributed by NVIDIA.</p>
<p>As you saw in <a href="https://nvidia.qwiklab.com/focuses/preview/1579?locale=en" target="_blank">Getting Started with Deep Learning,</a> DIGITS allows anyone to easily get started and interactively <em>train</em> their networks with GPU acceleration. </p>
<p>You also saw that any pre-trained model in DIGITS can immediately be applied to a new test image through the same browser interface in which it was trained. This is <em>inference.</em> <em>Inference</em> is a network's main job once deployed, so we'll use DIGITS as a first step.</p>
<hr>
<p>Click <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/digits/" target="_blank">here</a> to open DIGITS in a separate tab.  If at any time DIGITS asks you to login you can just make up a username and proceed.</p>
<p>The DIGITS server you will see running contains our two neural networks, <em>GoogLeNet</em> and <em>pedestrian_detectNet</em>, listed under the <code>"Models"</code> tab:</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/pretrained.png" alt=""></p>
<p>Click on the name of one of the models and scroll to the bottom to see the "Trained Models" view.  Here, you can <em>apply</em> the model to a single test image, a whole LMDB database of test images or a list of files referenced in a text file. Note that you have different options depending on the model you're using.</p>
<p><strong>Exercise:</strong> Follow the instructions in the image below to test the following single images that reside on the same server as the running DIGITS instance:</p>
<ol>
<li>For <em>GoogLeNet:</em> /home/ubuntu/deployment_lab/test_images/GN_test.png</li>
<li>For <em>pedestrian_detectNet:</em> /home/ubuntu/deployment_lab/test_images/DN_test.png</li>
</ol>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/digits_inference.png" alt=""></p>
<p>If you successfully follow these steps you should see one of the inference outputs below:</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/digits_inference_outputs.png" alt=""></p>
<p>(<strong>Optional Exercise - The power of additional computation</strong>) </p>
<p>Carry out the same inference task again using DetectNet but this time select a version of the model from an earlier epoch in the training process using <code>"Select Model</code>" dropdown.  You should find that models from earlier epochs produce less accurate detection results. Note that this is usually, but <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/model-fit-underfitting-vs-overfitting.html" target="_blank">not always</a> the case. </p>
<p>We've now used our trained network to make inferences on new data. Next, we'll deploy our model to production to carry out inference programatically. We'll start with a simple Python application that uses pycaffe, the same framework that DIGITS just used to infer. Through this process, we'll identify the files you need from DIGITS for deployment. You'll also learn to optimize your deployment for either throughput or latency by manipulating batch size.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 133px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Part 2: Inference using pycaffe</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">We will now walk through a simple example Python application that uses pycaffe to detect pedestrians in a test image using the pretrained DetectNet model introduced in Part 1.  Note that this example is representative of the way that inference is carried out in the majority of deep learning frameworks.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Run the following code to import libraries and configure Caffe to use the GPU for inference.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 133px;"></div><div class="CodeMirror-gutters" style="display: none; height: 146px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Part-2:-Inference-using-pycaffe">Part 2: Inference using pycaffe<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Part-2:-Inference-using-pycaffe"></a></h2>
<p>We will now walk through a simple example Python application that uses pycaffe to detect pedestrians in a test image using the pretrained DetectNet model introduced in Part 1.  Note that this example is representative of the way that inference is carried out in the majority of deep learning frameworks.</p>
<p>Run the following code to import libraries and configure Caffe to use the GPU for inference.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 107.594px; left: 74.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 357px; margin-bottom: -17px; border-right-width: 13px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 69px; top: 102px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Import required Python libraries</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pylab</span> <span class="cm-variable">inline</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pylab</span>.<span class="cm-variable">rcParams</span>[<span class="cm-string">'figure.figsize'</span>] = (<span class="cm-number">15</span>, <span class="cm-number">9</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">caffe</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">time</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">cv2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">IPython</span>.<span class="cm-variable">display</span> <span class="cm-keyword">import</span> <span class="cm-variable">clear_output</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Configure Caffe to use the GPU for inference</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">caffe</span>.<span class="cm-variable">set_mode_gpu</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 215px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Populating the interactive namespace from numpy and matplotlib
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 215px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">A model trained in DIGITS can be imported into pycaffe as an instance of the <span class="cm-comment">`caffe.Net`</span> class.  You can find the path of the directory containing the model definition files and trained model weights listed under <span class="cm-strong">**Job Directory</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**</span> at the top of the model's page in DIGITS.  For example:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"files/digits_job.png"</span> <span class="cm-attribute">alt</span>=<span class="cm-string">"Drawing"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 600px;"</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Simlarly if you look at the corresponding dataset in DIGITS you can find the <span class="cm-strong">**Job Directory**</span> containing the dataset mean image. The mean image was used to normalize training data, so it must also be use for inference as well.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise:**</span> Find the job directory for the pedestrian_detectnet model and the pedestrian_dummy_dataset and use them as the <span class="cm-comment">`MODEL_JOB_DIR`</span> and <span class="cm-comment">`DATA_JOB_DIR`</span> parameters in the code cells below to apply DetectNet to a sequence of test frames from the video <span class="cm-comment">`melbourne.mp4`</span> using pycaffe.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 215px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>A model trained in DIGITS can be imported into pycaffe as an instance of the <code>caffe.Net</code> class.  You can find the path of the directory containing the model definition files and trained model weights listed under <strong>Job Directory
</strong> at the top of the model's page in DIGITS.  For example:</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/digits_job.png" alt="Drawing" style="width: 600px"></p>
<p>Simlarly if you look at the corresponding dataset in DIGITS you can find the <strong>Job Directory</strong> containing the dataset mean image. The mean image was used to normalize training data, so it must also be use for inference as well.</p>
<p><strong>Exercise:</strong> Find the job directory for the pedestrian_detectnet model and the pedestrian_dummy_dataset and use them as the <code>MODEL_JOB_DIR</code> and <code>DATA_JOB_DIR</code> parameters in the code cells below to apply DetectNet to a sequence of test frames from the video <code>melbourne.mp4</code> using pycaffe.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.5938px; left: 513.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 526px; margin-bottom: -17px; border-right-width: 13px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 508px; top: 51px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Set the model job directory from DIGITS here</span></span></pre><pre><span style="padding-right: 0.1px;"><span class="cm-variable">MODEL_JOB_DIR</span>=<span class="cm-string">'/home/ubuntu/digits/digits/jobs/20160905-143028-2f08'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Set the data job directory from DIGITS here</span></span></pre><pre><span style="padding-right: 0.1px;"><span class="cm-variable">DATA_JOB_DIR</span>=<span class="cm-string">'/home/ubuntu/digits/digits/jobs/20160905-135347-01d5'</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">DIGITS makes the model weights after each epoch available as the "snapshot_iter_X.caffemodel" file. Below, we find the iteration number, X, of the last epoch and then instantiate both the model architecture ("deploy.prototxt") and trained model weights in GPU memory using "caffe.Net".</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>DIGITS makes the model weights after each epoch available as the "snapshot_iter_X.caffemodel" file. Below, we find the iteration number, X, of the last epoch and then instantiate both the model architecture ("deploy.prototxt") and trained model weights in GPU memory using "caffe.Net".</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[5]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.5938px; left: 451.891px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 634px; margin-bottom: -17px; border-right-width: 13px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 446.297px; top: 68px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># We need to find the iteration number of the final model snapshot saved by DIGITS</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">root</span>, <span class="cm-variable">dirs</span>, <span class="cm-variable">files</span> <span class="cm-keyword">in</span> <span class="cm-variable">os</span>.<span class="cm-variable">walk</span>(<span class="cm-variable">MODEL_JOB_DIR</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">f</span> <span class="cm-keyword">in</span> <span class="cm-variable">files</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">f</span>.<span class="cm-variable">endswith</span>(<span class="cm-string">'.solverstate'</span>):</span></pre><pre><span style="padding-right: 0.1px;">            <span class="cm-variable">last_iteration</span> = <span class="cm-variable">f</span>.<span class="cm-variable">split</span>(<span class="cm-string">'_'</span>)[<span class="cm-number">2</span>].<span class="cm-variable">split</span>(<span class="cm-string">'.'</span>)[<span class="cm-number">0</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'Last snapshot was after iteration: '</span> <span class="cm-operator">+</span> <span class="cm-variable">last_iteration</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Last snapshot was after iteration: 70800
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 857px; margin-bottom: -17px; border-right-width: 13px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Instantiate a Caffe model in GPU memory</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># The model architecture is defined in the deploy.prototxt file</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># The pretrained model weights are contained in the snapshot_iter_&lt;number&gt;.caffemodel file as detirmined above.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">classifier</span> = <span class="cm-variable">caffe</span>.<span class="cm-variable">Net</span>(<span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">MODEL_JOB_DIR</span>,<span class="cm-string">'deploy.prototxt'</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;">                       <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">MODEL_JOB_DIR</span>,<span class="cm-string">'snapshot_iter_'</span> <span class="cm-operator">+</span> <span class="cm-variable">last_iteration</span> <span class="cm-operator">+</span> <span class="cm-string">'.caffemodel'</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">                       <span class="cm-variable">caffe</span>.<span class="cm-variable">TEST</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 695.75px; margin-bottom: -17px; border-right-width: 13px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Load the dataset mean image file</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> = <span class="cm-variable">np</span>.<span class="cm-variable">load</span>(<span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">DATA_JOB_DIR</span>,<span class="cm-string">'train_db'</span>,<span class="cm-string">'mean.npy'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Instantiate a Caffe Transformer object that will preprocess test images before inference</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">transformer</span> = <span class="cm-variable">caffe</span>.<span class="cm-variable">io</span>.<span class="cm-variable">Transformer</span>({<span class="cm-string">'data'</span>: <span class="cm-variable">classifier</span>.<span class="cm-variable">blobs</span>[<span class="cm-string">'data'</span>].<span class="cm-variable">data</span>.<span class="cm-variable">shape</span>}) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">transformer</span>.<span class="cm-variable">set_transpose</span>(<span class="cm-string">'data'</span>, (<span class="cm-number">2</span>,<span class="cm-number">0</span>,<span class="cm-number">1</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">transformer</span>.<span class="cm-variable">set_mean</span>(<span class="cm-string">'data'</span>,<span class="cm-variable">mean</span>.<span class="cm-variable">mean</span>(<span class="cm-number">1</span>).<span class="cm-variable">mean</span>(<span class="cm-number">1</span>)<span class="cm-operator">/</span><span class="cm-number">255</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">transformer</span>.<span class="cm-variable">set_raw_scale</span>(<span class="cm-string">'data'</span>, <span class="cm-number">255</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">transformer</span>.<span class="cm-variable">set_channel_swap</span>(<span class="cm-string">'data'</span>, (<span class="cm-number">2</span>,<span class="cm-number">1</span>,<span class="cm-number">0</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">BATCH_SIZE</span>, <span class="cm-variable">CHANNELS</span>, <span class="cm-variable">HEIGHT</span>, <span class="cm-variable">WIDTH</span> = <span class="cm-variable">classifier</span>.<span class="cm-variable">blobs</span>[<span class="cm-string">'data'</span>].<span class="cm-variable">data</span>[<span class="cm-error">...</span>].<span class="cm-variable">shape</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'The input size for the network is: ('</span> <span class="cm-operator">+</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-builtin">str</span>(<span class="cm-variable">BATCH_SIZE</span>), <span class="cm-builtin">str</span>(<span class="cm-variable">CHANNELS</span>), <span class="cm-builtin">str</span>(<span class="cm-variable">HEIGHT</span>), <span class="cm-builtin">str</span>(<span class="cm-variable">WIDTH</span>) <span class="cm-operator">+</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">         <span class="cm-string">') (batch size, channels, height, width)'</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 266px;"></div><div class="CodeMirror-gutters" style="display: none; height: 279px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>The input size for the network is: (1 3 512 1024) (batch size, channels, height, width)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 351px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">We can now deploy our model programmatically. <span class="cm-em">*pedestrian_detectNet*</span> is designed to place bounding boxes around pedestrians. Our code needs to do three things:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Make our actual input look like the input layer of our network.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line"> </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable-2">Our input will be frames from a video stream. As shown above, our network will expect a height of 512 and a width of 1024. This is done using </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>frame = cv.resize(frame, (1024, 512), 0, 0)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-variable-2">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Infer</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>bounding_boxes = classifier.forward()['bbox-list'][0]" - classifier.forward <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-variable-2">is where the </span><span class="cm-em cm-variable-2">*actual*</span><span class="cm-variable-2"> inference happens. </span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Make our network's output match our intended output.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable-2">In this case, our model outputs an array of bounding box predictions where (bounding_box[0],bounding_box[1]) are the coordinates of one corner of each box and (bounding_box[2],bounding_box[3]) are the coordinates of the opposite corner. Our deployment then simply overlays rectangles using those coordinates to display where the pedestrians are.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line"> </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Run the following code block to deploy your model.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 351px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>We can now deploy our model programmatically. <em>pedestrian_detectNet</em> is designed to place bounding boxes around pedestrians. Our code needs to do three things:</p>
<ol>
<li><p>Make our actual input look like the input layer of our network.  </p>
<p> Our input will be frames from a video stream. As shown above, our network will expect a height of 512 and a width of 1024. This is done using <code>frame = cv.resize(frame, (1024, 512), 0, 0)</code>.</p>
</li>
<li><p>Infer</p>
<p> <code>bounding_boxes = classifier.forward()['bbox-list'][0]" - classifier.forward </code>is where the <em>actual</em> inference happens. </p>
</li>
<li><p>Make our network's output match our intended output.</p>
<p> In this case, our model outputs an array of bounding box predictions where (bounding_box[0],bounding_box[1]) are the coordinates of one corner of each box and (bounding_box[2],bounding_box[3]) are the coordinates of the opposite corner. Our deployment then simply overlays rectangles using those coordinates to display where the pedestrians are.  </p>
</li>
</ol>
<p>Run the following code block to deploy your model.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 749.359px; margin-bottom: -17px; border-right-width: 13px; min-height: 1167px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create opencv video object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">vid</span> = <span class="cm-variable">cv2</span>.<span class="cm-variable">VideoCapture</span>(<span class="cm-string">'/home/ubuntu/deployment_lab/melbourne.mp4'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># We will just use every n-th frame from the video</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">every_nth</span> = <span class="cm-number">10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">counter</span> = <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">try</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">while</span>(<span class="cm-builtin">True</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-comment"># Capture video frame-by-frame</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">ret</span>, <span class="cm-variable">frame</span> = <span class="cm-variable">vid</span>.<span class="cm-variable">read</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">counter</span> += <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        </span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-operator">not</span> <span class="cm-variable">ret</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Release the Video Device if ret is false</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">vid</span>.<span class="cm-variable">release</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Mesddage to be displayed after releasing the device</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">print</span> <span class="cm-string">"Released Video Resource"</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">break</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">counter</span><span class="cm-operator">%</span><span class="cm-variable">every_nth</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Resize the captured frame to match the DetectNet model</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">frame</span> = <span class="cm-variable">cv2</span>.<span class="cm-variable">resize</span>(<span class="cm-variable">frame</span>, (<span class="cm-number">1024</span>, <span class="cm-number">512</span>), <span class="cm-number">0</span>, <span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Use the Caffe transformer to preprocess the frame</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">data</span> = <span class="cm-variable">transformer</span>.<span class="cm-variable">preprocess</span>(<span class="cm-string">'data'</span>, <span class="cm-variable">frame</span>.<span class="cm-variable">astype</span>(<span class="cm-string">'float16'</span>)<span class="cm-operator">/</span><span class="cm-number">255</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Set the preprocessed frame to be the Caffe model's data layer</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">classifier</span>.<span class="cm-variable">blobs</span>[<span class="cm-string">'data'</span>].<span class="cm-variable">data</span>[<span class="cm-error">...</span>] = <span class="cm-variable">data</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Measure inference time for the feed-forward operation</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">start</span> = <span class="cm-variable">time</span>.<span class="cm-variable">time</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># The output of DetectNet is an array of bounding box predictions</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">bounding_boxes</span> = <span class="cm-variable">classifier</span>.<span class="cm-variable">forward</span>()[<span class="cm-string">'bbox-list'</span>][<span class="cm-number">0</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">end</span> = (<span class="cm-variable">time</span>.<span class="cm-variable">time</span>() <span class="cm-operator">-</span> <span class="cm-variable">start</span>)<span class="cm-operator">*</span><span class="cm-number">1000</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Convert the image from OpenCV BGR format to matplotlib RGB format for display</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">frame</span> = <span class="cm-variable">cv2</span>.<span class="cm-variable">cvtColor</span>(<span class="cm-variable">frame</span>, <span class="cm-variable">cv2</span>.<span class="cm-variable">COLOR_BGR2RGB</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Create a copy of the image for drawing bounding boxes</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">overlay</span> = <span class="cm-variable">frame</span>.<span class="cm-variable">copy</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Loop over the bounding box predictions and draw a rectangle for each bounding box</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">for</span> <span class="cm-variable">bbox</span> <span class="cm-keyword">in</span> <span class="cm-variable">bounding_boxes</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                <span class="cm-keyword">if</span>  <span class="cm-variable">bbox</span>.<span class="cm-builtin">sum</span>() <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-variable">cv2</span>.<span class="cm-variable">rectangle</span>(<span class="cm-variable">overlay</span>, (<span class="cm-variable">bbox</span>[<span class="cm-number">0</span>],<span class="cm-variable">bbox</span>[<span class="cm-number">1</span>]), (<span class="cm-variable">bbox</span>[<span class="cm-number">2</span>],<span class="cm-variable">bbox</span>[<span class="cm-number">3</span>]), (<span class="cm-number">255</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>), <span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                    </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Overlay the bounding box image on the original image</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">frame</span> = <span class="cm-variable">cv2</span>.<span class="cm-variable">addWeighted</span>(<span class="cm-variable">overlay</span>, <span class="cm-number">0.5</span>, <span class="cm-variable">frame</span>, <span class="cm-number">0.5</span>, <span class="cm-number">0</span>, <span class="cm-variable">frame</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Display the inference time per frame</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">cv2</span>.<span class="cm-variable">putText</span>(<span class="cm-variable">frame</span>,<span class="cm-string">"Inference time: %dms per frame"</span> <span class="cm-operator">%</span> <span class="cm-variable">end</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;">                        (<span class="cm-number">10</span>,<span class="cm-number">500</span>), <span class="cm-variable">cv2</span>.<span class="cm-variable">FONT_HERSHEY_SIMPLEX</span>,<span class="cm-number">1</span>,(<span class="cm-number">255</span>,<span class="cm-number">255</span>,<span class="cm-number">255</span>),<span class="cm-number">2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Display the frame</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">imshow</span>(<span class="cm-variable">frame</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">show</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Display the frame until new frame is available</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">clear_output</span>(<span class="cm-variable">wait</span>=<span class="cm-builtin">True</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># At any point you can stop the video playback and inference by  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># clicking on the stop (black square) icon at the top of the notebook</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">except</span> <span class="cm-variable">KeyboardInterrupt</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-comment"># Release the Video Device</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">vid</span>.<span class="cm-variable">release</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-comment"># Message to be displayed after releasing the device</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">"Released Video Resource"</span>            </span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 1167px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1180px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Released Video Resource
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 164px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">** Make sure to release the video resource by clicking on the stop (black square) icon at the top of the notebook.**</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">As you will see pycaffe can carry out DetectNet inference on a 1024x512 video frame in a time of about 73ms, or about 13.6 frames per second. Is this fast enough for your application?</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">The overhead of reading frames from the video and drawing the output frame with bounding box overlays slows down video playback. There is also a startup cost associated with initializing the model in memory.  In a production system you would often try to have the data ingest and output postprocessing taking place in a separate parallel thread to the Caffe inference.  You would also keep the model initialized in GPU memory to accept new data at any time without incurring the startup overhead again.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Make sure to release the video resource by clicking on the stop (black square) icon at the top of the notebook.</strong></p>
<p>As you will see pycaffe can carry out DetectNet inference on a 1024x512 video frame in a time of about 73ms, or about 13.6 frames per second. Is this fast enough for your application?</p>
<p>The overhead of reading frames from the video and drawing the output frame with bounding box overlays slows down video playback. There is also a startup cost associated with initializing the model in memory.  In a production system you would often try to have the data ingest and output postprocessing taking place in a separate parallel thread to the Caffe inference.  You would also keep the model initialized in GPU memory to accept new data at any time without incurring the startup overhead again.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 165px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Batch size effect on latency vs. throughput</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">In some applications we are less worried about the inference time for an indvidual frame (latency) and more concerned with how many frames we can process in a unit of time (throughput).  In these situations we can carry out inference as a batch process, just like during training.  In the case of video this would mean buffering frames until a batch is full and then carrying out inference.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise:**</span> Modify the code cell below to carry out inference on the same video as before but with batch sizes 1, 2, 5 and 8.  Compare the per frame inference time and throughput.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line"> </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 165px;"></div><div class="CodeMirror-gutters" style="display: none; height: 178px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Batch-size-effect-on-latency-vs.-throughput">Batch size effect on latency vs. throughput<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Batch-size-effect-on-latency-vs.-throughput"></a></h3>
<p>In some applications we are less worried about the inference time for an indvidual frame (latency) and more concerned with how many frames we can process in a unit of time (throughput).  In these situations we can carry out inference as a batch process, just like during training.  In the case of video this would mean buffering frames until a batch is full and then carrying out inference.</p>
<p><strong>Exercise:</strong> Modify the code cell below to carry out inference on the same video as before but with batch sizes 1, 2, 5 and 8.  Compare the per frame inference time and throughput.  </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 923.594px; left: 321.141px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 811.031px; margin-bottom: -17px; border-right-width: 13px; min-height: 946px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 315.547px; top: 918px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre><span style="padding-right: 0.1px;"><span class="cm-variable">NEW_BATCH_SIZE</span> = <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Resize the input data layer for the new batch size</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">OLD_BATCH_SIZE</span>, <span class="cm-variable">CHANNELS</span>, <span class="cm-variable">HEIGHT</span>, <span class="cm-variable">WIDTH</span> = <span class="cm-variable">classifier</span>.<span class="cm-variable">blobs</span>[<span class="cm-string">'data'</span>].<span class="cm-variable">data</span>[<span class="cm-error">...</span>].<span class="cm-variable">shape</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">classifier</span>.<span class="cm-variable">blobs</span>[<span class="cm-string">'data'</span>].<span class="cm-variable">reshape</span>(<span class="cm-variable">NEW_BATCH_SIZE</span>, <span class="cm-variable">CHANNELS</span>, <span class="cm-variable">HEIGHT</span>, <span class="cm-variable">WIDTH</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">classifier</span>.<span class="cm-variable">reshape</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create opencv video object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">vid</span> = <span class="cm-variable">cv2</span>.<span class="cm-variable">VideoCapture</span>(<span class="cm-string">'/home/ubuntu/deployment_lab/melbourne.mp4'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">counter</span> = <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">batch</span> = <span class="cm-variable">np</span>.<span class="cm-variable">zeros</span>((<span class="cm-variable">NEW_BATCH_SIZE</span>, <span class="cm-variable">CHANNELS</span>, <span class="cm-variable">HEIGHT</span>, <span class="cm-variable">WIDTH</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">try</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">while</span>(<span class="cm-builtin">True</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-comment"># Capture video frame-by-frame</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">ret</span>, <span class="cm-variable">frame</span> = <span class="cm-variable">vid</span>.<span class="cm-variable">read</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">        </span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-operator">not</span> <span class="cm-variable">ret</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Release the Video Device if ret is false</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">vid</span>.<span class="cm-variable">release</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Message to be displayed after releasing the device</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">print</span> <span class="cm-string">"Released Video Resource"</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">break</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-comment"># Resize the captured frame to match the DetectNet model</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">frame</span> = <span class="cm-variable">cv2</span>.<span class="cm-variable">resize</span>(<span class="cm-variable">frame</span>, (<span class="cm-variable">WIDTH</span>, <span class="cm-variable">HEIGHT</span>), <span class="cm-number">0</span>, <span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">        </span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-comment"># Add transformed frame to batch array</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">batch</span>[<span class="cm-variable">counter</span><span class="cm-operator">%</span><span class="cm-variable">NEW_BATCH_SIZE</span>,:,:,:] = <span class="cm-variable">transformer</span>.<span class="cm-variable">preprocess</span>(<span class="cm-string">'data'</span>, <span class="cm-variable">frame</span>.<span class="cm-variable">astype</span>(<span class="cm-string">'float16'</span>)<span class="cm-operator">/</span><span class="cm-number">255</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">counter</span> += <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        </span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">counter</span><span class="cm-operator">%</span><span class="cm-variable">NEW_BATCH_SIZE</span><span class="cm-operator">==</span><span class="cm-number">0</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Set the preprocessed frame to be the Caffe model's data layer</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">classifier</span>.<span class="cm-variable">blobs</span>[<span class="cm-string">'data'</span>].<span class="cm-variable">data</span>[<span class="cm-error">...</span>] = <span class="cm-variable">batch</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># Measure inference time for the feed-forward operation</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">start</span> = <span class="cm-variable">time</span>.<span class="cm-variable">time</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># The output of DetectNet is now an array of bounding box predictions</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-comment"># for each image in the input batch</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">bounding_boxes</span> = <span class="cm-variable">classifier</span>.<span class="cm-variable">forward</span>()[<span class="cm-string">'bbox-list'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">end</span> = (<span class="cm-variable">time</span>.<span class="cm-variable">time</span>() <span class="cm-operator">-</span> <span class="cm-variable">start</span>)<span class="cm-operator">*</span><span class="cm-number">1000</span></span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">print</span> <span class="cm-string">'Inference time: %dms per batch, %dms per frame, output size %s'</span> <span class="cm-operator">%</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">                    (<span class="cm-variable">end</span>, <span class="cm-variable">end</span><span class="cm-operator">/</span><span class="cm-variable">NEW_BATCH_SIZE</span>, <span class="cm-variable">bounding_boxes</span>.<span class="cm-variable">shape</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">            </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># At any point you can stop the video playback and inference by  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># clicking on the stop (black square) icon at the top of the notebook</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">except</span> <span class="cm-variable">KeyboardInterrupt</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-comment"># Release the Video Device</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">vid</span>.<span class="cm-variable">release</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-comment"># Message to be displayed after releasing the device</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">"Released Video Resource"</span>      </span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 946px;"></div><div class="CodeMirror-gutters" style="display: none; height: 959px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Inference time: 1654ms per batch, 1654ms per frame, output size (1, 50, 5)
Inference time: 2364ms per batch, 2364ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 75ms per batch, 75ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 75ms per batch, 75ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Inference time: 76ms per batch, 76ms per frame, output size (1, 50, 5)
Released Video Resource
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">NOTE: If you try a batch size greater than 8 you will run out of GPU memory and see an error from the notebook.  This is fine to do, but you will have to re-execute the previous code cells to get back to this point.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You should have found that per frame inference time decreases as batch size increases (higher throughput) but the time to process a whole batch also increases (higher latency).</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>NOTE: If you try a batch size greater than 8 you will run out of GPU memory and see an error from the notebook.  This is fine to do, but you will have to re-execute the previous code cells to get back to this point.</p>
<p>You should have found that per frame inference time decreases as batch size increases (higher throughput) but the time to process a whole batch also increases (higher latency).</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-hr">---</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-em">*IMPORTANT*</span> Execute the cell below before starting part 3:</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><hr>
<p><em>IMPORTANT</em> Execute the cell below before starting part 3:</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 718.844px; margin-bottom: -17px; border-right-width: 13px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Make sure to clean up the GPU memory that Caffe is using before we start this next section.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">try</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">del</span> <span class="cm-variable">mean</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">del</span> <span class="cm-variable">transformer</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">del</span> <span class="cm-variable">classifier</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">except</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">"Memory already freed"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 143px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 474px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Part 3: NVIDIA TensorRT</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">NVIDIA <span class="cm-link">[TensorRT]</span><span class="cm-string">(https://developer.nvidia.com/tensorrt)</span> (also referenced as GIE) is a high-performance deep learning inference solution for production environments. Power efficiency and speed of response are two key metrics for deployed deep learning applications, because they directly affect the user experience and the cost of the service provided. TensorRT automatically optimizes trained neural networks for run-time performance and delivers GPU-accelerated inference for web/mobile, embedded and automotive applications.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![GIE]</span><span class="cm-string">(GIE_Graphics_FINAL-1.png)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">There are two phases in the use of TensorRT: build and deployment.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">We are going to build a TensorRT runtime for the GoogLeNet model trained in DIGITS introduced in Part 1. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Build Phase</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">In the build phase, TensorRT performs optimizations on the network configuration and generates an optimized plan for computing the forward pass through the deep neural network. The <span class="cm-em">*plan*</span> is an optimized object code that can be serialized and stored in memory or on disk.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">We start by using the model job directory from DIGITS, just as we did in Task 2 using pycaffe, to get two files:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. a network architecture file (deploy.prototxt)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. trained weights (net.caffemodel)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise:**</span> Find the job directory for the GoogLeNet model in DIGITS and use it as the MODEL_JOB_DIR parameter "FIXME" in the code cell below:</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 474px;"></div><div class="CodeMirror-gutters" style="display: none; height: 487px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Part-3:-NVIDIA-TensorRT">Part 3: NVIDIA TensorRT<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Part-3:-NVIDIA-TensorRT"></a></h2>
<p>NVIDIA <a href="https://developer.nvidia.com/tensorrt" target="_blank">TensorRT</a> (also referenced as GIE) is a high-performance deep learning inference solution for production environments. Power efficiency and speed of response are two key metrics for deployed deep learning applications, because they directly affect the user experience and the cost of the service provided. TensorRT automatically optimizes trained neural networks for run-time performance and delivers GPU-accelerated inference for web/mobile, embedded and automotive applications.</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/GIE_Graphics_FINAL-1.png" alt="GIE"></p>
<p>There are two phases in the use of TensorRT: build and deployment.</p>
<p>We are going to build a TensorRT runtime for the GoogLeNet model trained in DIGITS introduced in Part 1. </p>
<h3 id="Build-Phase">Build Phase<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Build-Phase"></a></h3>
<p>In the build phase, TensorRT performs optimizations on the network configuration and generates an optimized plan for computing the forward pass through the deep neural network. The <em>plan</em> is an optimized object code that can be serialized and stored in memory or on disk.</p>
<p>We start by using the model job directory from DIGITS, just as we did in Task 2 using pycaffe, to get two files:</p>
<ol>
<li>a network architecture file (deploy.prototxt)</li>
<li>trained weights (net.caffemodel)</li>
</ol>
<p><strong>Exercise:</strong> Find the job directory for the GoogLeNet model in DIGITS and use it as the MODEL_JOB_DIR parameter "FIXME" in the code cell below:</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[12]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5938px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 634px; margin-bottom: -17px; border-right-width: 13px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Set the model job directory from DIGITS here</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">MODEL_JOB_DIR</span>=<span class="cm-string">'FIXME'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># We need to find the iteration number of the final model snapshot saved by DIGITS</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">root</span>, <span class="cm-variable">dirs</span>, <span class="cm-variable">files</span> <span class="cm-keyword">in</span> <span class="cm-variable">os</span>.<span class="cm-variable">walk</span>(<span class="cm-variable">MODEL_JOB_DIR</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">f</span> <span class="cm-keyword">in</span> <span class="cm-variable">files</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">f</span>.<span class="cm-variable">endswith</span>(<span class="cm-string">'.solverstate'</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-variable">last_iteration</span> = <span class="cm-variable">f</span>.<span class="cm-variable">split</span>(<span class="cm-string">'_'</span>)[<span class="cm-number">2</span>].<span class="cm-variable">split</span>(<span class="cm-string">'.'</span>)[<span class="cm-number">0</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">architecture_file</span> = <span class="cm-variable">MODEL_JOB_DIR</span><span class="cm-operator">+</span><span class="cm-string">'/deploy.prototxt'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">weights_file</span> = <span class="cm-variable">MODEL_JOB_DIR</span><span class="cm-operator">+</span><span class="cm-string">'/snapshot_iter_'</span><span class="cm-operator">+</span><span class="cm-variable">last_iteration</span><span class="cm-operator">+</span><span class="cm-string">'.caffemodel'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">"Architecture file name = "</span><span class="cm-operator">+</span><span class="cm-variable">architecture_file</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">"Trained weights file name = "</span><span class="cm-operator">+</span><span class="cm-variable">weights_file</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Architecture file name = FIXME/deploy.prototxt
Trained weights file name = FIXME/snapshot_iter_70800.caffemodel
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 317px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">The two files above are used in the file <span class="cm-comment">`InferenceEngine.cpp`</span> in the editor below. <span class="cm-comment">`InferenceEngine.cpp`</span> takes a Caffe model and generates a TensorRT object called a 'plan.'</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Plans are smaller than the combination of the models and weights and can be run on the deployment hardware without needing to install and run on top of a deep learning framework.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">The builder (lines 36-42) is responsible for reading the network information when the create_plan application is called.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Note: The builder can also be used to define network information directly if no .prototxt file is available.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Significant lines to inspect in this file are:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- line 46 - the output layer from the network is chosen, we are using the "softmax" layer as we want to classify images.  If we wished to use TensorRT to extract features from an intermediate layer of the network we could specify that layer by name here.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- line 49 - we choose the maximium input batch size that will be used.  In this example we simply process one image at a time (batch size 1), but if we wished to maximize throughput at the expense of latency we could process larger batches.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- line 50 - TensorRT performs layer optimizations to reduce inference time.  While this is transparent to the user, analyzing the network layers requires memory, so you must specify the maximum workspace size.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 317px;"></div><div class="CodeMirror-gutters" style="display: none; height: 347px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The two files above are used in the file <code>InferenceEngine.cpp</code> in the editor below. <code>InferenceEngine.cpp</code> takes a Caffe model and generates a TensorRT object called a 'plan.'</p>
<p>Plans are smaller than the combination of the models and weights and can be run on the deployment hardware without needing to install and run on top of a deep learning framework.</p>
<p>The builder (lines 36-42) is responsible for reading the network information when the create_plan application is called.</p>
<p>Note: The builder can also be used to define network information directly if no .prototxt file is available.</p>
<p>Significant lines to inspect in this file are:</p>
<ul>
<li>line 46 - the output layer from the network is chosen, we are using the "softmax" layer as we want to classify images.  If we wished to use TensorRT to extract features from an intermediate layer of the network we could specify that layer by name here.</li>
<li>line 49 - we choose the maximium input batch size that will be used.  In this example we simply process one image at a time (batch size 1), but if we wished to maximize throughput at the expense of latency we could process larger batches.</li>
<li>line 50 - TensorRT performs layer optimizations to reduce inference time.  While this is transparent to the user, analyzing the network layers requires memory, so you must specify the maximum workspace size.</li>
</ul>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">iframe</span> <span class="cm-attribute">id</span>=<span class="cm-string">"task1"</span> <span class="cm-attribute">src</span>=<span class="cm-string">"task1"</span> <span class="cm-attribute">width</span>=<span class="cm-string">"100%"</span> <span class="cm-attribute">height</span>=<span class="cm-string">"400px"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Your browser does not support iframes.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">iframe</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><iframe id="task1" width="100%" height="400px" src="./Neural Network Deployment with DIGITS and TensorRT_files/saved_resource.html">
    &lt;p&gt;Your browser does not support iframes.&lt;/p&gt;
</iframe></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Once you have finished inspecting the InferenceEngine.cpp code execute the command below to build the simple create_plan application which will call InferenceEngine and serialize the generated TensorRT object to disk.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Once you have finished inspecting the InferenceEngine.cpp code execute the command below to build the simple create_plan application which will call InferenceEngine and serialize the generated TensorRT object to disk.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[13]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 444.141px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 441.547px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 438.547px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">cd</span> <span class="cm-operator">/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">GRE_Web_Demo</span><span class="cm-operator">/</span><span class="cm-variable">GIEEngine</span><span class="cm-operator">/</span><span class="cm-variable">src</span><span class="cm-operator">/</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">make</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">echo</span> <span class="cm-string">"create_plan app created"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>nvcc -std=c++11 -O2 -c -o create_plan.o create_plan.cpp
nvcc -std=c++11 -O2 -c -o InferenceEngine.o InferenceEngine.cpp
nvcc -std=c++11 -O2 -o create_plan create_plan.o InferenceEngine.o -lglog -lnvinfer -lnvcaffe_parser
create_plan app created
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">We can now use the create_plan application to generate a TensorRT object from our GoogLeNet model trained in DIGITS.  Execute the cell below to do this - the final line specifies where the TensorRT object (sometimes called a plan) will be written.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>We can now use the create_plan application to generate a TensorRT object from our GoogLeNet model trained in DIGITS.  Execute the cell below to do this - the final line specifies where the TensorRT object (sometimes called a plan) will be written.</p>
</div></div></div><div class="cell code_cell rendered selected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.5938px; left: 367.25px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 418.516px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 361.656px; top: 51px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">GRE_Web_Demo</span><span class="cm-operator">/</span><span class="cm-variable">GIEEngine</span><span class="cm-operator">/</span><span class="cm-variable">src</span><span class="cm-operator">/</span><span class="cm-variable">create_plan</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{<span class="cm-variable">architecture_file</span>} <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{<span class="cm-variable">weights_file</span>} <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">~/</span><span class="cm-variable">GRE_Web_Demo</span><span class="cm-operator">/</span><span class="cm-variable">GIEEngine</span><span class="cm-operator">/</span><span class="cm-variable">src</span><span class="cm-operator">/</span><span class="cm-variable">imagenet</span>.<span class="cm-variable">plan</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">echo</span> <span class="cm-string">"Plan created"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>could not open file FIXME/snapshot_iter_70800.caffemodel
Plan created
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 130px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">If the output of the block above says "Plan created," move on to deployment. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">If the output of the block above says, "Aborted (core dumped)," check to make sure you've put the Model Job Directory for GoogLeNet and not pedestrian_detectNet in the first block of task 3. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">While it'd be interesting to demonstrate <span class="cm-em">*pedestrian_detectNet*</span> through TensorRT, <span class="cm-em">*pedestrian_detectNet*</span> has some custom layers that make doing that beyond the scope of this lab.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 143px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>If the output of the block above says "Plan created," move on to deployment. </p>
<p>If the output of the block above says, "Aborted (core dumped)," check to make sure you've put the Model Job Directory for GoogLeNet and not pedestrian_detectNet in the first block of task 3. </p>
<p>While it'd be interesting to demonstrate <em>pedestrian_detectNet</em> through TensorRT, <em>pedestrian_detectNet</em> has some custom layers that make doing that beyond the scope of this lab.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 29px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Deploy Phase</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 29px;"></div><div class="CodeMirror-gutters" style="display: none; height: 42px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Deploy-Phase">Deploy Phase<a class="anchor-link" href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#Deploy-Phase"></a></h3>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 232px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">With your "plan" created, the next step is to batch and stream data to and from the runtime inference engine. This is beyond the scope of this lab, however the <span class="cm-comment">`classification.cpp`</span> file in the editor below contains the key steps required to use the inference engine to process a batch of input data and generate a result. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">We have created a <span class="cm-link">[Docker]</span><span class="cm-string">(https://www.docker.com/)</span> container called gre_gie that contains an application called GIE that uses <span class="cm-comment">`classifiation.cpp`</span> to instantiate a TensorRT inference engine from the plan we created and process images that it is passed through a REST service called GRE. The <span class="cm-link">[NVIDIA GPU REST Engine (GRE)]</span><span class="cm-string">(https://developer.nvidia.com/gre)</span> is a critical component for developers building low-latency web services. GRE includes a multi-threaded HTTP server that presents a <span class="cm-link">[RESTful]</span><span class="cm-string">(https://en.wikipedia.org/wiki/Representational_state_transfer)</span> web service and schedules requests efficiently across multiple NVIDIA GPUs. The overall response time depends on how much processing you need to do, but GRE itself adds very little overhead and can process null-requests in as little as 10 microseconds.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 232px;"></div><div class="CodeMirror-gutters" style="display: none; height: 245px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>With your "plan" created, the next step is to batch and stream data to and from the runtime inference engine. This is beyond the scope of this lab, however the <code>classification.cpp</code> file in the editor below contains the key steps required to use the inference engine to process a batch of input data and generate a result. </p>
<p>We have created a <a href="https://www.docker.com/" target="_blank">Docker</a> container called gre_gie that contains an application called GIE that uses <code>classifiation.cpp</code> to instantiate a TensorRT inference engine from the plan we created and process images that it is passed through a REST service called GRE. The <a href="https://developer.nvidia.com/gre" target="_blank">NVIDIA GPU REST Engine (GRE)</a> is a critical component for developers building low-latency web services. GRE includes a multi-threaded HTTP server that presents a <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank">RESTful</a> web service and schedules requests efficiently across multiple NVIDIA GPUs. The overall response time depends on how much processing you need to do, but GRE itself adds very little overhead and can process null-requests in as little as 10 microseconds.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">iframe</span> <span class="cm-attribute">id</span>=<span class="cm-string">"task2"</span> <span class="cm-attribute">src</span>=<span class="cm-string">"task2"</span> <span class="cm-attribute">width</span>=<span class="cm-string">"100%"</span> <span class="cm-attribute">height</span>=<span class="cm-string">"400px"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Your browser does not support iframes.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">iframe</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><iframe id="task2" width="100%" height="400px" src="./Neural Network Deployment with DIGITS and TensorRT_files/saved_resource(1).html">
    &lt;p&gt;Your browser does not support iframes.&lt;/p&gt;
</iframe></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Execute the cell below to use <span class="cm-link">[NVIDIA Docker]</span><span class="cm-string">(https://github.com/NVIDIA/nvidia-docker)</span> to launch the gre_gie container.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Execute the cell below to use <a href="https://github.com/NVIDIA/nvidia-docker" target="_blank">NVIDIA Docker</a> to launch the gre_gie container.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 533.891px; margin-bottom: -17px; border-right-width: 13px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">nvidia</span><span class="cm-operator">-</span><span class="cm-variable">docker</span> <span class="cm-variable">run</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">-</span><span class="cm-variable">d</span> <span class="cm-operator">--</span><span class="cm-variable">name</span> <span class="cm-variable">gre_gie</span> <span class="cm-operator">-</span><span class="cm-variable">p</span> <span class="cm-number">8085</span>:<span class="cm-number">8000</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">GRE_Web_Demo</span><span class="cm-operator">/</span><span class="cm-variable">GIEEngine</span><span class="cm-operator">/</span><span class="cm-variable">src</span>:<span class="cm-operator">/</span><span class="cm-variable">inference</span><span class="cm-operator">-</span><span class="cm-variable">engine</span>:<span class="cm-variable">ro</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">caffe</span><span class="cm-operator">/</span><span class="cm-variable">data</span><span class="cm-operator">/</span><span class="cm-variable">ilsvrc12</span>:<span class="cm-operator">/</span><span class="cm-variable">imagenet</span>:<span class="cm-variable">ro</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">gre_gie</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">inference</span><span class="cm-operator">-</span><span class="cm-variable">engine</span><span class="cm-operator">/</span><span class="cm-variable">imagenet</span>.<span class="cm-variable">plan</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">imagenet</span><span class="cm-operator">/</span><span class="cm-variable">imagenet_mean</span>.<span class="cm-variable">binaryproto</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">imagenet</span><span class="cm-operator">/</span><span class="cm-variable">synset_words</span>.<span class="cm-variable">txt</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">echo</span> <span class="cm-string">"GIE container running"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">In order to compare the output and performance between Caffe and TensorRT, we have also created a second container called gre_caffegpu that carries out inference on images passed through GRE but uses GPU accelerated Caffe instead of TensorRT.  The Caffe container uses the same native Caffe model for inference as we used to create the TensorRT plan above.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>In order to compare the output and performance between Caffe and TensorRT, we have also created a second container called gre_caffegpu that carries out inference on images passed through GRE but uses GPU accelerated Caffe instead of TensorRT.  The Caffe container uses the same native Caffe model for inference as we used to create the TensorRT plan above.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 549.266px; margin-bottom: -17px; border-right-width: 13px; min-height: 181px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">nvidia</span><span class="cm-operator">-</span><span class="cm-variable">docker</span> <span class="cm-variable">run</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">-</span><span class="cm-variable">d</span> <span class="cm-operator">--</span><span class="cm-variable">name</span> <span class="cm-variable">gre_caffegpu</span> <span class="cm-operator">-</span><span class="cm-variable">p</span> <span class="cm-number">8082</span>:<span class="cm-number">8000</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">digits</span><span class="cm-operator">/</span><span class="cm-variable">digits</span><span class="cm-operator">/</span><span class="cm-variable">jobs</span><span class="cm-operator">/</span><span class="cm-number">20160908</span><span class="cm-operator">-</span><span class="cm-number">203605</span><span class="cm-operator">-</span><span class="cm-variable">e46b</span>:<span class="cm-operator">/</span><span class="cm-variable">model</span>:<span class="cm-variable">ro</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">caffe</span><span class="cm-operator">/</span><span class="cm-variable">data</span><span class="cm-operator">/</span><span class="cm-variable">ilsvrc12</span>:<span class="cm-operator">/</span><span class="cm-variable">imagenet</span>:<span class="cm-variable">ro</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">gre_caffegpu</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">model</span><span class="cm-operator">/</span><span class="cm-variable">deploy</span>.<span class="cm-variable">prototxt</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">model</span><span class="cm-operator">/</span><span class="cm-variable">snapshot_iter_32</span>.<span class="cm-variable">caffemodel</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">imagenet</span><span class="cm-operator">/</span><span class="cm-variable">imagenet_mean</span>.<span class="cm-variable">binaryproto</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-operator">/</span><span class="cm-variable">imagenet</span><span class="cm-operator">/</span><span class="cm-variable">synset_words</span>.<span class="cm-variable">txt</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">echo</span> <span class="cm-string">"Caffe GPU container running"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 181px;"></div><div class="CodeMirror-gutters" style="display: none; height: 194px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Finally, we created a Docker container called gre_frontend that generates a simple web interface that you can upload or link an image to and have it classified using either the TensorRT application in the gre_gie container or native GPU Caffe in the gre_caffegpu container.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Execute the cell below to start the web interface.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Finally, we created a Docker container called gre_frontend that generates a simple web interface that you can upload or link an image to and have it classified using either the TensorRT application in the gre_gie container or native GPU Caffe in the gre_caffegpu container.</p>
<p>Execute the cell below to start the web interface.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 672.453px; margin-bottom: -17px; border-right-width: 13px; min-height: 181px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">nvidia</span><span class="cm-operator">-</span><span class="cm-variable">docker</span> <span class="cm-variable">run</span> <span class="cm-operator">--</span><span class="cm-variable">name</span> <span class="cm-variable">gre_frontend</span> <span class="cm-operator">-</span><span class="cm-variable">d</span> <span class="cm-operator">--</span><span class="cm-variable">net</span>=<span class="cm-variable">host</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">/</span><span class="cm-variable">home</span><span class="cm-operator">/</span><span class="cm-variable">ubuntu</span><span class="cm-operator">/</span><span class="cm-variable">GRE_Web_Demo</span><span class="cm-operator">/</span><span class="cm-variable">FrontEnd</span><span class="cm-operator">/</span><span class="cm-variable">WebFrontEnd</span>:<span class="cm-operator">/</span><span class="cm-variable">HTTP_server</span> <span class="cm-variable">gre_frontend</span> <span class="cm-variable">FrontEnd</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8080"</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8081"</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8082"</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8083"</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8084"</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8085"</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-string">"0.0.0.0:8086"</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-error">\</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">echo</span> <span class="cm-string">"GIE web demo container running"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 181px;"></div><div class="CodeMirror-gutters" style="display: none; height: 194px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Once you have received the "GIE container running", "Caffe GPU container running" and "GIE web demo container running" messages above**</span>, click <span class="cm-link">[here]</span><span class="cm-string">(/gre/)</span> to connect to the GIE web interface in a separate tab.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You should see a screen like this:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/GRE.png)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Once you have received the "GIE container running", "Caffe GPU container running" and "GIE web demo container running" messages above</strong>, click <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/gre/" target="_blank">here</a> to connect to the GIE web interface in a separate tab.</p>
<p>You should see a screen like this:</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/GRE.png" alt=""></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 232px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">You can now classify an image provided through the web interface through either the running GIE (Using TensorRT) or Caffe containers. Either click <span class="cm-link">[here]</span><span class="cm-string">(files/test_images/GN_test.png)</span> to open our GoogLeNet test image and save it to disk or if you wish you can use your own test image, either by uploading or linking to a .png or .jpeg:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Click on "Image Classification" in the top left corner</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Input URL or click choose file and point to your test image.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Click either the "Caffe" or "GIE" buttons to pass the image to the running GIE or Caffe container for classification</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">4. Click both the "profile" buttons to plot the time taken for making the web request, image preprocessing and inference using GIE and Caffe</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You should see an output like this:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/GREoutput.png)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 232px;"></div><div class="CodeMirror-gutters" style="display: none; height: 245px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>You can now classify an image provided through the web interface through either the running GIE (Using TensorRT) or Caffe containers. Either click <a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/files/test_images/GN_test.png" target="_blank">here</a> to open our GoogLeNet test image and save it to disk or if you wish you can use your own test image, either by uploading or linking to a .png or .jpeg:</p>
<ol>
<li>Click on "Image Classification" in the top left corner</li>
<li>Input URL or click choose file and point to your test image.</li>
<li>Click either the "Caffe" or "GIE" buttons to pass the image to the running GIE or Caffe container for classification</li>
<li>Click both the "profile" buttons to plot the time taken for making the web request, image preprocessing and inference using GIE and Caffe</li>
</ol>
<p>You should see an output like this:</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/GREoutput.png" alt=""></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 283px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;">We see that the GIE inference time (dark green bar, using TensorRT) is lower than the Caffe time (light green bar). We also see that we got the same output using both models.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">TensorRT optimizes models for inference by performing several important transformations and optimizations to the neural network graph. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Note that the inference time here includes image preprocessing and the overhead of making a web request, so it is not a true representation of the maximum possible inference speed of TensorRT or Caffe and it is also running an older K520 GPU. To measure the true performance benefits we compared the per-layer timings of the GoogLeNet network using Caffe and TensorRT on NVIDIA Tesla M4 GPUs with a batch size of 1 averaged over 1000 iterations with GPU clocks fixed in the P0 state.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(files/GIE_GoogLeNet_top10kernels-1.png)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For more information on these transformations see the TensorRT Parallel Forall blog post <span class="cm-link">[here]</span><span class="cm-string">(https://devblogs.nvidia.com/parallelforall/production-deep-learning-nvidia-gpu-inference-engine/)</span>. Note that TensorRT currently supports the following layer types:</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>We see that the GIE inference time (dark green bar, using TensorRT) is lower than the Caffe time (light green bar). We also see that we got the same output using both models.</p>
<p>TensorRT optimizes models for inference by performing several important transformations and optimizations to the neural network graph. </p>
<p>Note that the inference time here includes image preprocessing and the overhead of making a web request, so it is not a true representation of the maximum possible inference speed of TensorRT or Caffe and it is also running an older K520 GPU. To measure the true performance benefits we compared the per-layer timings of the GoogLeNet network using Caffe and TensorRT on NVIDIA Tesla M4 GPUs with a batch size of 1 averaged over 1000 iterations with GPU clocks fixed in the P0 state.</p>
<p><img src="./Neural Network Deployment with DIGITS and TensorRT_files/GIE_GoogLeNet_top10kernels-1.png" alt=""></p>
<p>For more information on these transformations see the TensorRT Parallel Forall blog post <a href="https://devblogs.nvidia.com/parallelforall/production-deep-learning-nvidia-gpu-inference-engine/" target="_blank">here</a>. Note that TensorRT currently supports the following layer types:</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Convolution: 2D</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Activation: ReLU, tanh and sigmoid</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Pooling: max and average</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- ElementWise: sum, product or max of two tensors</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- LRN: cross-channel only</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Fully-connected: with or without bias</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- SoftMax: cross-channel only</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Deconvolution</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li>Convolution: 2D</li>
<li>Activation: ReLU, tanh and sigmoid</li>
<li>Pooling: max and average</li>
<li>ElementWise: sum, product or max of two tensors</li>
<li>LRN: cross-channel only</li>
<li>Fully-connected: with or without bias</li>
<li>SoftMax: cross-channel only</li>
<li>Deconvolution</li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 372px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># stop and remove any existing docker containers</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">sudo</span> <span class="cm-variable">docker</span> <span class="cm-variable">stop</span> <span class="cm-error">$</span>(<span class="cm-variable">docker</span> <span class="cm-variable">ps</span> <span class="cm-operator">-</span><span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-variable">q</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">sudo</span> <span class="cm-variable">docker</span> <span class="cm-variable">rm</span> <span class="cm-error">$</span>(<span class="cm-variable">docker</span> <span class="cm-variable">ps</span> <span class="cm-operator">-</span><span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-variable">q</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 79px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">You're now able to take model definition files and trained weights from DIGITS and deploy them using pycaffe and TensorRT. You've seen the effect of batchsize on throughput and latency. You've also seen the difference in workflow and performance when using a high performance inference engine. Combining these skills and this knowhow with previous labs, you should be able to begin solving supervised machine learning problems from dataset to production.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>You're now able to take model definition files and trained weights from DIGITS and deploy them using pycaffe and TensorRT. You've seen the effect of batchsize on throughput and latency. You've also seen the difference in workflow and performance when using a high performance inference engine. Combining these skills and this knowhow with previous labs, you should be able to begin solving supervised machine learning problems from dataset to production.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Keep learning! Check out our other offerings with the link below.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Keep learning! Check out our other offerings with the link below.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://www.nvidia.com/en-us/deep-learning-ai/education/</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"files/DLI Header.png"</span> <span class="cm-attribute">alt</span>=<span class="cm-string">"Drawing"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 400px;"</span><span class="cm-tag cm-bracket">/&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p> <a href="https://www.nvidia.com/en-us/deep-learning-ai/education/" target="_blank"> <img src="./Neural Network Deployment with DIGITS and TensorRT_files/DLI Header.png" alt="Drawing" style="width: 400px"> </a></p>
</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="http://ec2-54-74-215-64.eu-west-1.compute.amazonaws.com/jrYW68Fsc/notebooks/Neural%20Network%20Deployment%20with%20DIGITS%20and%20TensorRT.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"os_name": "posix", "sys_version": "2.7.6 (default, Jun 22 2015, 17:58:13) \n[GCC 4.8.2]", "default_encoding": "ANSI_X3.4-1968", "sys_platform": "linux2", "ipython_version": "3.2.1", "ipython_path": "/usr/local/lib/python2.7/dist-packages/IPython", "commit_source": "installation", "platform": "Linux-3.13.0-46-generic-x86_64-with-Ubuntu-14.04-trusty", "sys_executable": "/usr/bin/python", "commit_hash": "2d95975"};
</script>

<script src="./Neural Network Deployment with DIGITS and TensorRT_files/encoding.js.download" charset="utf-8"></script>

<script src="./Neural Network Deployment with DIGITS and TensorRT_files/main.js.download" charset="utf-8"></script>





<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, monospace;"></div></div></body></html>